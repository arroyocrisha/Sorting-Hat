<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Sorting Hat | 20 Question Trial</title>
    <style>
        :root {
            --gryffindor: #9e0000;
            --ravenclaw: #004a9e;
            --hufflepuff: #e3a000;
            --slytherin: #1a472a;
            --gold: #d4af37;
            --glass: rgba(15, 15, 15, 0.85);
        }

        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            font-family: 'Georgia', serif;
            color: #eee;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* Animated Magical Background */
        .bg-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('https://images.unsplash.com/photo-1510218830377-4e996247732e?auto=format&fit=crop&q=80&w=2000') no-repeat center center/cover;
            z-index: -1;
            filter: brightness(0.4);
            animation: zoomEffect 20s infinite alternate;
        }

        @keyframes zoomEffect {
            from { transform: scale(1); }
            to { transform: scale(1.1); }
        }

        .main-card {
            background: var(--glass);
            backdrop-filter: blur(10px);
            border: 2px solid #333;
            border-radius: 20px;
            padding: 40px;
            width: 90%;
            max-width: 650px;
            text-align: center;
            box-shadow: 0 0 50px rgba(0,0,0,0.8);
            position: relative;
            animation: fadeIn 1s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h1 { color: var(--gold); letter-spacing: 5px; text-shadow: 0 0 15px var(--gold); margin-top: 0; }

        /* Question Transition Animation */
        .question-fade {
            animation: slideIn 0.5s forwards;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(30px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .options-grid {
            display: grid;
            gap: 15px;
            margin-top: 30px;
        }

        .option-btn {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid #444;
            color: #ddd;
            padding: 15px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: left;
            font-size: 1rem;
        }

        .option-btn:hover {
            background: rgba(212, 175, 55, 0.15);
            border-color: var(--gold);
            color: white;
            transform: scale(1.02);
        }

        .progress-bar {
            width: 100%;
            height: 4px;
            background: #222;
            margin-bottom: 20px;
            border-radius: 2px;
        }

        .progress-fill {
            height: 100%;
            background: var(--gold);
            width: 0%;
            transition: width 0.4s;
        }

        #thinking-screen, #result-page, #follow-up { display: none; }

        .hat-loader {
            font-size: 50px;
            animation: wobble 2s infinite;
            display: inline-block;
        }

        @keyframes wobble {
            0%, 100% { transform: rotate(-5deg); }
            50% { transform: rotate(5deg); }
        }

        #result-emoji { font-size: 80px; }
        .credits { margin-top: 30px; font-size: 0.8rem; color: #777; }

        @media print {
            .bg-container, .main-card, button { display: none; }
            #cert-print { display: block !important; background: #fdf5e6; color: black; padding: 50px; height: 100vh; }
        }
    </style>
</head>
<body>

<div class="bg-container"></div>

<div class="main-card" id="quiz-container">
    <div id="start-page">
        <h1>THE SORTING HAT</h1>
        <p>Twenty questions to reveal your true magical nature. Answer with your soul, not your head.</p>
        <button class="option-btn" style="text-align: center; width: 200px; margin: 20px auto; display: block;" onclick="startQuiz()">Begin Trial</button>
        <p class="credits">by ccarroyo</p>
    </div>

    <div id="quiz-page" style="display: none;">
        <div class="progress-bar"><div id="progress" class="progress-fill"></div></div>
        <p id="q-count" style="color: var(--gold); font-size: 0.9rem;"></p>
        <h2 id="q-text" class="question-fade"></h2>
        <div id="options" class="options-grid"></div>
    </div>

    <div id="thinking-screen">
        <div class="hat-loader">üß¢</div>
        <h2>The Hat is deliberating...</h2>
        <p>"A difficult mind to read... yes..."</p>
    </div>

    <div id="result-page">
        <div id="result-emoji"></div>
        <h1 id="house-title"></h1>
        <p id="personality-text"></p>
        <button class="option-btn" style="width: 100%; text-align: center;" onclick="location.reload()">Reset Test</button>
        <p class="credits">by ccarroyo</p>
    </div>
</div>

<script>
    const questions = [
        { q: "The Forbidden Tome: You find a book that amplifies power but corrupts. You...", options: [
            { t: "Destroy it immediately.", h: "gryffindor" }, { t: "Study its logic safely.", h: "ravenclaw" }, 
            { t: "Hide it to protect others.", h: "hufflepuff" }, { t: "Use it to gain influence.", h: "slytherin" }
        ]},
        { q: "A village is trapped in a curse. Your first move?", options: [
            { t: "Rush in to break it.", h: "gryffindor" }, { t: "Research the curse's origin.", h: "ravenclaw" }, 
            { t: "Provide food and care to victims.", h: "hufflepuff" }, { t: "Find out who is paying to fix it.", h: "slytherin" }
        ]},
        { q: "A friend commits a crime for a good cause. You...", options: [
            { t: "Insist they face justice.", h: "gryffindor" }, { t: "Evaluate the logic of the cause.", h: "ravenclaw" }, 
            { t: "Protect their secret at any cost.", h: "hufflepuff" }, { t: "Use the secret for future leverage.", h: "slytherin" }
        ]},
        { q: "You can win a duel by risking an innocent. You...", options: [
            { t: "Refuse and take the blow yourself.", h: "gryffindor" }, { t: "Calculate a 1% chance to save both.", h: "ravenclaw" }, 
            { t: "Surrender to ensure safety.", h: "hufflepuff" }, { t: "Win. The end justifies the means.", h: "slytherin" }
        ]},
        { q: "What do you fear most?", options: [
            { t: "Being called a coward.", h: "gryffindor" }, { t: "Being misunderstood or ignorant.", h: "ravenclaw" }, 
            { t: "Losing your community.", h: "hufflepuff" }, { t: "Being powerless.", h: "slytherin" }
        ]},
        { q: "The Whispering Forest offers secrets. You...", options: [
            { t: "Enter boldly to see for yourself.", h: "gryffindor" }, { t: "Bring a journal to record the truths.", h: "ravenclaw" }, 
            { t: "Avoid it; some secrets hurt people.", h: "hufflepuff" }, { t: "Listen to gain an edge over rivals.", h: "slytherin" }
        ]},
        { q: "Your favorite magical tool would be...", options: [
            { t: "A sword of legendary bravery.", h: "gryffindor" }, { t: "A diadem of infinite wisdom.", h: "ravenclaw" }, 
            { t: "A cup that heals and provides.", h: "hufflepuff" }, { t: "A locket that commands respect.", h: "slytherin" }
        ]},
        { q: "How would you like to be remembered?", options: [
            { t: "As a hero.", h: "gryffindor" }, { t: "As a genius.", h: "ravenclaw" }, 
            { t: "As a true friend.", h: "hufflepuff" }, { t: "As a great leader.", h: "slytherin" }
        ]},
        { q: "A stranger is being bullied. You...", options: [
            { t: "Step in and fight the bully.", h: "gryffindor" }, { t: "Outsmart the bully with words.", h: "ravenclaw" }, 
            { t: "Comfort the victim first.", h: "hufflepuff" }, { t: "Wait for the best moment to intervene.", h: "slytherin" }
        ]},
        { q: "You find a $100 magical coin. You...", options: [
            { t: "Buy gear for an adventure.", h: "gryffindor" }, { t: "Buy a rare, ancient book.", h: "ravenclaw" }, 
            { t: "Treat your friends to a feast.", h: "hufflepuff" }, { t: "Invest it to grow your wealth.", h: "slytherin" }
        ]},
        { q: "The Mirror of Erised shows...", options: [
            { t: "You standing atop a mountain.", h: "gryffindor" }, { t: "You mastering every spell.", h: "ravenclaw" }, 
            { t: "Your family safe and happy.", h: "hufflepuff" }, { t: "You sitting on a throne.", h: "slytherin" }
        ]},
        { q: "Pick a path:", options: [
            { t: "The dangerous, sunny trail.", h: "gryffindor" }, { t: "The quiet, winding library path.", h: "ravenclaw" }, 
            { t: "The wide, paved common road.", h: "hufflepuff" }, { t: "The narrow, shortcut alleyway.", h: "slytherin" }
        ]},
        { q: "If you could change the past, you would...", options: [
            { t: "Correct a great injustice.", h: "gryffindor" }, { t: "Learn a truth that was lost.", h: "ravenclaw" }, 
            { t: "Prevent a friend's heartbreak.", h: "hufflepuff" }, { t: "Fix a mistake that cost you power.", h: "slytherin" }
        ]},
        { q: "A door is locked. You...", options: [
            { t: "Kick it down.", h: "gryffindor" }, { t: "Find the complex counter-spell.", h: "ravenclaw" }, 
            { t: "Knock and wait patiently.", h: "hufflepuff" }, { t: "Pick the lock secretly.", h: "slytherin" }
        ]},
        { q: "In a team, you are...", options: [
            { t: "The Vanguard.", h: "gryffindor" }, { t: "The Strategist.", h: "ravenclaw" }, 
            { t: "The Supporter.", h: "hufflepuff" }, { t: "The Captain.", h: "slytherin" }
        ]},
        { q: "You're late for class. You...", options: [
            { t: "Run in and apologize loudly.", h: "gryffindor" }, { t: "Slip in and hope for no questions.", h: "ravenclaw" }, 
            { t: "Feel guilty all day.", h: "hufflepuff" }, { t: "Blame the moving staircases.", h: "slytherin" }
        ]},
        { q: "A potion goes wrong. You...", options: [
            { t: "Try to contain the explosion.", h: "gryffindor" }, { t: "Analyze the chemical error.", h: "ravenclaw" }, 
            { t: "Help clean up the mess.", h: "hufflepuff" }, { t: "Ensure your grade isn't affected.", h: "slytherin" }
        ]},
        { q: "What is your best quality?", options: [
            { t: "Bravery.", h: "gryffindor" }, { t: "Intelligence.", h: "ravenclaw" }, 
            { t: "Kindness.", h: "hufflepuff" }, { t: "Resourcefulness.", h: "slytherin" }
        ]},
        { q: "You're given a task. You...", options: [
            { t: "Dive in head-first.", h: "gryffindor" }, { t: "Make a detailed plan.", h: "ravenclaw" }, 
            { t: "Collaborate with others.", h: "hufflepuff" }, { t: "Find the most efficient shortcut.", h: "slytherin" }
        ]},
        { q: "The Hat says you'd be great in Slytherin, but you want Gryffindor. You...", options: [
            { t: "Argue for Gryffindor.", h: "gryffindor" }, { t: "Ask for the Hat's reasoning.", h: "ravenclaw" }, 
            { t: "Go where you're needed.", h: "hufflepuff" }, { t: "Accept it; Slytherin has perks.", h: "slytherin" }
        ]}
    ];

    let currentIdx = 0;
    let scores = { gryffindor: 0, ravenclaw: 0, hufflepuff: 0, slytherin: 0 };

    function startQuiz() {
        document.getElementById('start-page').style.display = 'none';
        document.getElementById('quiz-page').style.display = 'block';
        showQuestion();
    }

    function showQuestion() {
        if (currentIdx >= questions.length) {
            processResults();
            return;
        }
        
        const q = questions[currentIdx];
        document.getElementById('q-count').innerText = `TRIAL ${currentIdx + 1} OF 20`;
        const qText = document.getElementById('q-text');
        qText.innerText = q.q;
        qText.classList.remove('question-fade');
        void qText.offsetWidth; // Trigger reflow
        qText.classList.add('question-fade');

        document.getElementById('progress').style.width = `${(currentIdx / questions.length) * 100}%`;

        const optionsDiv = document.getElementById('options');
        optionsDiv.innerHTML = '';
        
        q.options.forEach(opt => {
            const btn = document.createElement('button');
            btn.className = 'option-btn';
            btn.innerText = opt.t;
            btn.onclick = () => {
                scores[opt.h]++;
                currentIdx++;
                showQuestion();
            };
            optionsDiv.appendChild(btn);
        });
    }

    function processResults() {
        document.getElementById('quiz-page').style.display = 'none';
        document.getElementById('thinking-screen').style.display = 'block';

        setTimeout(() => {
            document.getElementById('thinking-screen').style.display = 'none';
            document.getElementById('result-page').style.display = 'block';
            
            const winner = Object.keys(scores).reduce((a, b) => scores[a] > scores[b] ? a : b);
            const emoji = { gryffindor: "ü¶Å", ravenclaw: "ü¶Ö", hufflepuff: "ü¶°", slytherin: "üêç" };
            const profiles = {
                gryffindor: "Your heart burns with the fire of courage. You choose the hard path because it is right.",
                ravenclaw: "Your mind is a vast library of curiosity. You seek truth above all simple comforts.",
                hufflepuff: "Your soul is anchored in loyalty and kindness. You are the foundation of your world.",
                slytherin: "Your ambition is your compass. You are resourceful, cunning, and destined for greatness."
            };

            document.getElementById('result-emoji').innerText = emoji[winner];
            document.getElementById('house-title').innerText = winner.toUpperCase();
            document.getElementById('personality-text').innerText = profiles[winner];
        }, 2500);
    }
</script>

</body>
</html>
