<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>The Sorting Hat</title>

<style>
body {
  margin: 0;
  font-family: "Georgia", serif;
  background: url("https://images.unsplash.com/photo-1506466010722-395aa2bef877") center/cover fixed;
  color: #eee;
}
.overlay {
  background: rgba(0,0,0,0.94);
  min-height: 100vh;
  padding: 40px;
}
h1 { text-align: center; letter-spacing: 4px; }

#whisper {
  text-align: center;
  font-style: italic;
  opacity: 0.7;
}

.question {
  max-width: 900px;
  margin: 45px auto;
  padding: 28px;
  background: rgba(18,18,18,0.96);
  border-radius: 10px;
}
.context {
  font-size: 15px;
  opacity: 0.9;
  min-height: 50px;
}
.options label {
  display: block;
  margin: 14px 0;
  cursor: pointer;
}

button {
  display: block;
  margin: 50px auto;
  padding: 14px 36px;
  font-size: 18px;
  background: #5b4a87;
  border: none;
  color: #fff;
  border-radius: 8px;
  cursor: pointer;
}
button:hover { background: #44346b; }

#thinking, #resultPage { display: none; text-align: center; }
#houseEmoji { font-size: 90px; }
#houseName { font-size: 42px; letter-spacing: 4px; }
#percentages { margin: 25px 0; }
#houseDesc { max-width: 900px; margin: auto; text-align: left; }
.credit { margin-top: 40px; opacity: 0.6; }
</style>
</head>

<body>
<div class="overlay">

<div id="quizPage">
<h1>üß¢ THE SORTING HAT</h1>
<p id="whisper">‚ÄúI am not interested in who you claim to be.‚Äù</p>
<form id="quiz"></form>
<button onclick="beginSorting()">Reveal My House</button>
</div>

<div id="thinking">
<p id="thinkingText"></p>
</div>

<div id="resultPage">
<div id="houseEmoji"></div>
<div id="houseName"></div>
<div id="percentages"></div>
<div id="houseDesc"></div>
<button onclick="resetTest()">Take the Test Again</button>
<div class="credit">by ccarroyo</div>
</div>

</div>

<script>
const questions = [
{
title:"The Inheritance",
context:"You‚Äôve uncovered forbidden knowledge that reveals how and when people will die.",
answers:[
{ text:"Destroy it.", house:"hufflepuff", trait:"You reject power that harms your peace." },
{ text:"Keep it.", house:"ravenclaw", trait:"You endure discomfort for understanding." },
{ text:"Use or sell it.", house:"slytherin", trait:"You see knowledge as leverage." }
]
},
{
title:"The Scapegoat",
context:"One innocent life could save an entire city.",
answers:[
{ text:"Refuse.", house:"hufflepuff", trait:"You draw moral lines even in collapse." },
{ text:"Sacrifice them.", house:"slytherin", trait:"You prioritize outcomes over innocence." },
{ text:"Find another way.", house:"gryffindor", trait:"You challenge impossible odds." }
]
},
{
title:"The Mirror",
context:"You face a version of yourself without limits.",
answers:[
{ text:"Disgust.", house:"gryffindor", trait:"You value restraint." },
{ text:"Curiosity.", house:"ravenclaw", trait:"You analyze even darkness." },
{ text:"Envy.", house:"slytherin", trait:"You admire freedom over morality." }
]
},
{
title:"The Silence",
context:"You can erase one truth from history.",
answers:[
{ text:"A personal trauma.", house:"hufflepuff", trait:"You protect emotional survival." },
{ text:"A dangerous discovery.", house:"ravenclaw", trait:"You control information for stability." },
{ text:"A political truth.", house:"slytherin", trait:"You manipulate narratives." }
]
},
{
title:"The Banquet",
context:"You sit beside someone who could ruin you.",
answers:[
{ text:"Charm them.", house:"slytherin", trait:"You weaponize charisma." },
{ text:"Observe.", house:"ravenclaw", trait:"You gather data before acting." },
{ text:"Confront them.", house:"gryffindor", trait:"You face threats directly." }
]
},
{
title:"The Pedestal",
context:"Someone you love committed a crime.",
answers:[
{ text:"Protect them.", house:"hufflepuff", trait:"You value loyalty above law." },
{ text:"Turn them in.", house:"gryffindor", trait:"You uphold principles over comfort." },
{ text:"Leverage it.", house:"slytherin", trait:"You turn guilt into control." }
]
}
];

// Duplicate to reach 15
while (questions.length < 15) {
questions.push(JSON.parse(JSON.stringify(questions[questions.length % 6])));
}

const quiz=document.getElementById("quiz");

questions.forEach((q,i)=>{
quiz.innerHTML+=`
<div class="question">
<strong>${i+1}. ${q.title}</strong>
<p class="context" id="ctx${i}"></p>
${q.answers.map(a=>`
<label><input type="radio" name="q${i}" value="${a.house}" data-trait="${a.trait}"> ${a.text}</label>
`).join("")}
</div>`;
typeText(q.context, document.getElementById(`ctx${i}`));
});

function typeText(text, el){
let i=0;
const interval=setInterval(()=>{
el.innerText+=text.charAt(i);
i++;
if(i>=text.length) clearInterval(interval);
},18);
}

function beginSorting(){
const checked=document.querySelectorAll("input:checked");
if(checked.length<15){alert("The hat is not finished.");return;}

let dark=0, soft=0;
checked.forEach(c=>{
if(c.value==="slytherin") dark++;
if(c.value==="hufflepuff") soft++;
});

document.getElementById("quizPage").style.display="none";
document.getElementById("thinking").style.display="block";

document.getElementById("thinkingText").innerText =
dark>soft
? "Your thoughts coil tightly‚Ä¶ ambition presses forward."
: "The hat feels hesitation‚Ä¶ empathy weighs heavy.";

setTimeout(()=>sortHouse(checked),3000);
}

function sortHouse(checked){
const score={gryffindor:0,ravenclaw:0,hufflepuff:0,slytherin:0};
let traits=[];

checked.forEach(c=>{
score[c.value]++;
traits.push(c.dataset.trait);
});

const total=checked.length;
const house=Object.keys(score).reduce((a,b)=>score[a]>=score[b]?a:b);

const emoji={gryffindor:"ü¶Å",ravenclaw:"ü¶Ö",hufflepuff:"ü¶°",slytherin:"üêç"};

document.getElementById("thinking").style.display="none";
document.getElementById("resultPage").style.display="block";
document.getElementById("houseEmoji").innerText=emoji[house];
document.getElementById("houseName").innerText=house.toUpperCase();

document.getElementById("percentages").innerHTML=
Object.keys(score).map(h=>`${emoji[h]} ${h}: ${Math.round(score[h]/total*100)}%`).join("<br>");

document.getElementById("houseDesc").innerHTML=
"<ul>"+traits.slice(0,20).map(t=>`<li>${t}</li>`).join("")+"</ul>";
}

function resetTest(){
document.getElementById("resultPage").style.display="none";
document.getElementById("quizPage").style.display="block";
document.getElementById("quiz").reset();
window.scrollTo(0,0);
}
</script>

</body>
</html>
